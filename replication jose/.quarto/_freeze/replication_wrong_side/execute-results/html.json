{
  "hash": "08bdfd44d23ffbded717dd79a95393d2",
  "result": {
    "markdown": "---\ntitle: \"Replication - Ananat (AER, 2011) - The Wrong Side(s) of the Tracks: The Causal Effects of Racial Segregation on Urban Poverty and Inequality\"\nauthor: \"José Arteta and Igor Brito\"\ndate: \"2023-06\"\nexecute: \n  warning: false\n---\n\n\n# Replication of the Paper - Ananat 2011\n\n## Introduction\n\nAlthough there seems to exist a striking negative correlation between racial segregation and population characteristics, this relationship may not be causal. Segregation holds a longstanding position as one of the prime suspects in explaining the persistent economic inequality between blacks and whites as more segregates cities, on average, have worse characteristics than less segregated cities, which is evident on measures ranging from infant mortality to educational achievement ( Douglas S. Massey and Nancy A. Denton 1993). However, several researchers remain skeptical on the causal influence of segregation on individual labor market outcomes and human capital outcomes. This skepticism can be summarized by two main reasons : Omitted variable bias and endogenous migration. For the first case it might be that some unmeasured economic or political attribute may lead cities to have both more segregation and more negative characteristics. For the second case it might be that people dislike segregation and those with higher wages migrate.\n\nThis paper examines the causal effects of racial segregation on labor market outcomes and human capital accumulation. It uses the exogenous variation of the configuration of railroad tracks configuration on american cities prior to the Great Migration, from 1915 to 1950. Historical records suggests that railroad configuration choices were determined by orientation of destinations and variation in ground slope, thus serving as an exogenous instrument. With this the author can study the phenomenon of the \"wrong side of the tracks\" by showing that cities that were subdivided by railroads into greater number of physically defined neighborhoods became significantly more segregated after the Great Migration. So using this instrument the author finds that increasing segregation increases inequality between a city's blacks and whites, and lowers average outcomes within the city's black community, while reducing inequality within the city's white community.\n\n![Tracks](wrongside.png)\n\n### Data sources\n\nFor this paper the author uses\n\n## A\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Packages used\nlibrary(tidyverse)\nlibrary(stargazer)\nlibrary(haven)\nlibrary(ggthemes)\nlibrary(estimatr)\nlibrary(magrittr)\nlibrary(modelsummary)\nlibrary(huxtable)\nlibrary(kableExtra)\nlibrary(sjPlot)\nlibrary(texreg)\nlibrary(fixest)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load data\naej_maindata <- read_dta(\"Data/aej_maindata.dta\")\ntable_5 <- read_dta(\"Data/table_5.dta\")\ntable_A1 <- read_dta(\"Data/table_A1.dta\")\n\n\n# Some minor preparations for the data\n\n# Creates Median of “railroad division index (RDI in our dataset herf)\n# Calcualtes the median of the RDI (herf)\nmedian_herf <- median(aej_maindata$herf)\n\n# Creates the dummy variable if RDI is below or above the median\naej_maindata <- aej_maindata %>%\n  mutate(high_herf = factor(if_else(herf >= median_herf , 1,0) ))\n```\n:::\n\n\n## Generating results\n\n$$\nR D I=1-\\sum_i\\left(\\frac{\\text { area }_{\\text {neighborhoodi }}}{\\text { area }_{\\text {total }}}\\right)^2\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(aej_maindata, aes(x =  herf, y=dism1990))+\n  geom_point(color = \"#377EB8\", size = 3)+\n  geom_text(aes(label = name), vjust = 1.2, color = \"#377EB8\", size = 5) +\n  geom_smooth(method =  \"lm\", se = F, color = \"#E41A1C\")+\n  labs(title =  \"Full Sample Relationship between RDI and Segregation\",\n       subtitle = \"Replication of Figure 3\",\n       x = \"RDI\",\n       y =  \"1990 segregation\") +\n  theme_stata()+\n  theme(plot.background = element_rect(fill = \"white\"),\n        plot.title = element_text(hjust = 0.5, size = 20), \n        plot.subtitle = element_text(hjust = 0.5, size = 17), \n        axis.title.x = element_text(hjust = 0.5, size = 17), \n        axis.title.y = element_text(hjust = 0.5, size = 17))\n```\n\n::: {.cell-output-display}\n![Replication of Figure 3](replication_wrong_side_files/figure-html/figure_3_rdi_distance-1.png){width=960}\n:::\n:::\n\n\n$$\n\\text { Index of dissimilarity }=\\frac{1}{2} \\sum_{i=1}^N\\left|\\frac{\\text { black }_i}{\\text { black }_{\\text {total }}}-\\frac{\\text { nonblack }_i}{\\text { nonblack }_{\\text {total }}}\\right| \\text {, }\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Graph 2 of Figure 4\nggplot(aej_maindata, aes(x = closeness, y = dism1990)) +\n  geom_line(aes(color = high_herf), stat = 'smooth', method = 'lm', se = FALSE, size = 3) +\n  geom_ribbon(aes(ymin = ..ymin.., ymax = ..ymax.., color = high_herf), \n              stat = 'smooth', method = 'lm', linetype = 1, fill = NA) +\n  geom_point(aes(color = high_herf), size = 3) +\n  labs(title =  \"Relationship between Distance to the South \n       and Segregation, by RDI\",\n       subtitle = \"Replication of Figure 4\",\n       x = \"Distance from the South\",\n       y =  \"1990 segregation\",\n       color = \"High RDI\") +\n  scale_color_manual(values = c(\"#E41A1C\", \"#377EB8\")) +\n  scale_fill_manual(values = c(\"#E41A1C\", \"#377EB8\"))+\n  theme_stata()+\n  theme(plot.background = element_rect(fill = \"white\"),\n        plot.title = element_text(hjust = 0.5, size = 20), # Centralize and bigger title\n        plot.subtitle = element_text(hjust = 0.5, size = 17), # Centralize and bigger subtitle\n        axis.title.x = element_text(hjust = 0.5, size = 17), # Centralize and bigger x axis label\n        axis.title.y = element_text(hjust = 0.5, size = 17))+ # Centralize and bigger y axis label\n  scale_x_continuous(limits = c(-1500, 0)) +\n  scale_y_continuous(limits = c(0.2, 1))\n```\n\n::: {.cell-output-display}\n![Replication of Figure 4](replication_wrong_side_files/figure-html/figure_4_rdi_distance-1.png){width=960}\n:::\n:::\n\n\n## Table 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Table 1\ntab1_reg1 <- lm(dism1990 ~ herf + lenper, data = aej_maindata)\ntab1_reg2 <- lm(area1910 ~ herf + lenper, data = aej_maindata)\ntab1_reg3 <- lm(count1910 ~ herf + lenper, data = aej_maindata)\ntab1_reg4 <- lm(ethseg10 ~ herf + lenper, data = aej_maindata)\ntab1_reg5 <- lm(ethiso10 ~ herf + lenper, data = aej_maindata)\ntab1_reg6 <- lm(black1910 ~ herf + lenper, data = aej_maindata)\ntab1_reg7 <- lm(passpc ~ herf + lenper, data = aej_maindata)\ntab1_reg8 <- lm(black1920 ~ herf + lenper, data = aej_maindata)\ntab1_reg9 <- lm(ctyliterate1920 ~ herf + lenper, data = aej_maindata)\ntab1_reg10 <- lm(lfp1920 ~ herf + lenper, data = aej_maindata)\ntab1_reg11 <- lm(ctytrade_wkrs1920 ~ herf + lenper,data = aej_maindata)\ntab1_reg12 <- lm(ctymanuf_wkrs1920 ~ herf + lenper, data = aej_maindata)\ntab1_reg13 <- lm(ctyrail_wkrs1920 ~ herf + lenper, data = aej_maindata)\ntab1_reg14 <- lm(incseg ~ herf + lenper, data = aej_maindata)\n```\n:::\n\n\n```{.r .cell-code}\nstargazer(tab1_reg1,\n          covariate.labels = c(\"RDI\", \n                               \"Track length per square kilometer\", \"Intercept\"),\n          dep.var.labels = \"1990 dissimilarity index\",\n          title =  \"FIRST STAGE - IV\",\n          se = starprep(tab1_reg1, se_type = \"stata\"), type = \"html\")\n```\n\n\n<table style=\"text-align:center\"><caption><strong>FIRST STAGE - IV</strong></caption>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"1\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td>1990 dissimilarity index</td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">RDI</td><td>0.357<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.088)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">Track length per square kilometer</td><td>18.514<sup>*</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(10.731)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">Intercept</td><td>0.294<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.064)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>121</td></tr>\n<tr><td style=\"text-align:left\">R<sup>2</sup></td><td>0.203</td></tr>\n<tr><td style=\"text-align:left\">Adjusted R<sup>2</sup></td><td>0.189</td></tr>\n<tr><td style=\"text-align:left\">Residual Std. Error</td><td>0.122 (df = 118)</td></tr>\n<tr><td style=\"text-align:left\">F Statistic</td><td>14.983<sup>***</sup> (df = 2; 118)</td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\n```{.r .cell-code}\nstargazer(tab1_reg2, tab1_reg3, tab1_reg4,\n          tab1_reg5, tab1_reg6, tab1_reg7,\n          se = starprep(tab1_reg2, tab1_reg3,\n                        tab1_reg4, tab1_reg5, \n                        tab1_reg6, tab1_reg7,\n                        se_type = \"stata\"), \n          header = FALSE,\n          type = \"html\",\n          title = \"Testing RDI as an Instrument\",\n          covariate.labels = c(\"RDI\", \n                               \"Track length per square kilometer\",\n                               \"Intercept\"),\n          dep.var.labels = c(\"Physical area  (square miles/1,000)\",\n                             \"Pop. (1,000s)\", \n                             \"Ethnic dissimilarity index\", \n                             \"Ethnic isolation index\", \n                             \"Percent blacks\",\n                             \"Street-cars per cap. (1,000s) (1915)\"),\n          column.labels = c(\"FALSIFICATION CHECKS\",\n                            \"FALSIFICATION CHECKS\",\n                            \"FALSIFICATION CHECKS\", \n                            \"FALSIFICATION CHECKS\", \n                            \"FALSIFICATION CHECKS\",\n                            \"FALSIFICATION CHECKS\"),\n          column.separate = c(6))\n```\n\n\n<table style=\"text-align:center\"><caption><strong>Testing RDI as an Instrument</strong></caption>\n<tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td colspan=\"6\"><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"6\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td>Physical area (square miles/1,000)</td><td>Pop. (1,000s)</td><td>Ethnic dissimilarity index</td><td>Ethnic isolation index</td><td>Percent blacks</td><td>Street-cars per cap. (1,000s) (1915)</td></tr>\n<tr><td style=\"text-align:left\"></td><td colspan=\"6\">FALSIFICATION CHECKS</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td><td>(5)</td><td>(6)</td></tr>\n<tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">RDI</td><td>-3,992.637</td><td>665.751</td><td>0.076</td><td>0.027</td><td>-0.001</td><td>-132.106</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(11,986.490)</td><td>(1,362.964)</td><td>(0.185)</td><td>(0.070)</td><td>(0.010)</td><td>(183.214)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Track length per square kilometer</td><td>-574,401.000</td><td>75,553.190</td><td>15.343</td><td>-12.439</td><td>9.236<sup>***</sup></td><td>3,360.586</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(553,669.000)</td><td>(134,814.900)</td><td>(53.248)</td><td>(17.288)</td><td>(0.650)</td><td>(20,507.370)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Intercept</td><td>18,409.570<sup>**</sup></td><td>976.876</td><td>0.238<sup>**</sup></td><td>0.048</td><td>0.007</td><td>274.892<sup>**</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(8,612.320)</td><td>(927.189)</td><td>(0.121)</td><td>(0.051)</td><td>(0.007)</td><td>(135.348)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>58</td><td>121</td><td>49</td><td>49</td><td>121</td><td>13</td></tr>\n<tr><td style=\"text-align:left\">R<sup>2</sup></td><td>0.007</td><td>0.006</td><td>0.014</td><td>0.009</td><td>0.290</td><td>0.093</td></tr>\n<tr><td style=\"text-align:left\">Adjusted R<sup>2</sup></td><td>-0.029</td><td>-0.011</td><td>-0.029</td><td>-0.034</td><td>0.278</td><td>-0.088</td></tr>\n<tr><td style=\"text-align:left\">Residual Std. Error</td><td>15,050.340 (df = 55)</td><td>1,903.415 (df = 118)</td><td>0.184 (df = 46)</td><td>0.075 (df = 46)</td><td>0.018 (df = 118)</td><td>73.196 (df = 10)</td></tr>\n<tr><td style=\"text-align:left\">F Statistic</td><td>0.186 (df = 2; 55)</td><td>0.373 (df = 2; 118)</td><td>0.321 (df = 2; 46)</td><td>0.202 (df = 2; 46)</td><td>24.147<sup>***</sup> (df = 2; 118)</td><td>0.514 (df = 2; 10)</td></tr>\n<tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td colspan=\"6\" style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\n```{.r .cell-code}\nstargazer(tab1_reg8, tab1_reg9,\n          tab1_reg10, tab1_reg11,\n          tab1_reg12,\n          se = starprep(tab1_reg8, tab1_reg9,\n                        tab1_reg10, tab1_reg11,\n                        tab1_reg12, \n                        se_type = \"stata\"), \n          header = FALSE,\n          type = \"html\",\n          title = \"Testing RDI as an Instrument\",\n          covariate.labels = c(\"RDI\", \n                               \"Track length per square kilometer\",\n                               \"Intercept\"),\n          dep.var.labels = c(\"Percent black\", \n                             \"Percent literate\",\n                             \"Labor force  participation\",\n                             \"Percent of empl. in trade\",\n                             \"Percent of empl. in  manufac.\"))\n```\n\n\n<table style=\"text-align:center\"><caption><strong>Testing RDI as an Instrument</strong></caption>\n<tr><td colspan=\"6\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td colspan=\"5\"><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"5\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td>Percent black</td><td>Percent literate</td><td>Labor force participation</td><td>Percent of empl. in trade</td><td>Percent of empl. in manufac.</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td><td>(5)</td></tr>\n<tr><td colspan=\"6\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">RDI</td><td>0.013</td><td>0.053<sup>*</sup></td><td>0.028</td><td>-0.080</td><td>0.191</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.009)</td><td>(0.030)</td><td>(0.024)</td><td>(0.094)</td><td>(0.137)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Track length per square kilometer</td><td>9.119<sup>***</sup></td><td>0.180</td><td>-3.427<sup>**</sup></td><td>-0.152</td><td>18.400<sup>*</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.615)</td><td>(0.880)</td><td>(1.500)</td><td>(2.910)</td><td>(10.911)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Intercept</td><td>-0.002</td><td>0.920<sup>***</sup></td><td>0.401<sup>***</sup></td><td>0.116<sup>*</sup></td><td>0.307<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.006)</td><td>(0.024)</td><td>(0.018)</td><td>(0.067)</td><td>(0.102)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td colspan=\"6\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>121</td><td>121</td><td>121</td><td>121</td><td>121</td></tr>\n<tr><td style=\"text-align:left\">R<sup>2</sup></td><td>0.359</td><td>0.042</td><td>0.015</td><td>0.010</td><td>0.041</td></tr>\n<tr><td style=\"text-align:left\">Adjusted R<sup>2</sup></td><td>0.348</td><td>0.026</td><td>-0.002</td><td>-0.006</td><td>0.025</td></tr>\n<tr><td style=\"text-align:left\">Residual Std. Error (df = 118)</td><td>0.016</td><td>0.036</td><td>0.042</td><td>0.113</td><td>0.193</td></tr>\n<tr><td style=\"text-align:left\">F Statistic (df = 2; 118)</td><td>33.073<sup>***</sup></td><td>2.574<sup>*</sup></td><td>0.869</td><td>0.615</td><td>2.542<sup>*</sup></td></tr>\n<tr><td colspan=\"6\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td colspan=\"5\" style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\n```{.r .cell-code}\nstargazer(tab1_reg13, tab1_reg14,\n          se = starprep(tab1_reg13, tab1_reg14, \n                        se_type = \"stata\"), \n          header = FALSE,\n          type = \"html\",\n          title = \"Testing RDI as an Instrument\",\n          covariate.labels = c(\"RDI\", \n                               \"Track length per square kilometer\",\n                               \"Intercept\"),\n          dep.var.labels = c(\"Percent of  empl. in railroads\",\n                             \"1990 income seg\"))\n```\n\n\n<table style=\"text-align:center\"><caption><strong>Testing RDI as an Instrument</strong></caption>\n<tr><td colspan=\"3\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td colspan=\"2\"><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td>Percent of empl. in railroads</td><td>1990 income seg</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(1)</td><td>(2)</td></tr>\n<tr><td colspan=\"3\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">RDI</td><td>-0.074</td><td>0.032</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.068)</td><td>(0.032)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Track length per square kilometer</td><td>1.592</td><td>-2.504</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(2.428)</td><td>(1.626)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Intercept</td><td>0.055</td><td>0.196<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.051)</td><td>(0.025)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td></tr>\n<tr><td colspan=\"3\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>121</td><td>69</td></tr>\n<tr><td style=\"text-align:left\">R<sup>2</sup></td><td>0.101</td><td>0.028</td></tr>\n<tr><td style=\"text-align:left\">Adjusted R<sup>2</sup></td><td>0.086</td><td>-0.001</td></tr>\n<tr><td style=\"text-align:left\">Residual Std. Error</td><td>0.030 (df = 118)</td><td>0.032 (df = 66)</td></tr>\n<tr><td style=\"text-align:left\">F Statistic</td><td>6.656<sup>***</sup> (df = 2; 118)</td><td>0.958 (df = 2; 66)</td></tr>\n<tr><td colspan=\"3\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td colspan=\"2\" style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\n## Table 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Table 2 panel 1\ntab2_p1_reg1 <- lm_robust(lngini_w ~ dism1990,se_type = \"stata\",data = aej_maindata)\ntab2_p1_reg2 <- lm_robust(lngini_b ~ dism1990,se_type = \"stata\",data = aej_maindata)\ntab2_p1_reg3 <- lm_robust(povrate_w ~ dism1990,se_type = \"stata\",data = aej_maindata)\ntab2_p1_reg4 <- lm_robust(povrate_b ~ dism1990,se_type = \"stata\",data = aej_maindata)\n\ntab2_p1_ivreg1 <- iv_robust(lngini_w ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\ntab2_p1_ivreg2 <- iv_robust(lngini_b ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\ntab2_p1_ivreg3 <- iv_robust(povrate_w ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\ntab2_p1_ivreg4 <- iv_robust(povrate_b ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\n\n# Closeness < -400 --------------------------------------------------------------------------------------------------\naej_maindata_tab2 <- aej_maindata %>%\n  filter(closeness < -400)\n#--------------------------------------------------------------------------------------------------------------------\ntab2_p1_reg5 <- lm_robust(lngini_w ~ herf + lenper,se_type = \"stata\",data = aej_maindata_tab2)\ntab2_p1_reg6 <- lm_robust(lngini_b ~ herf + lenper,se_type = \"stata\",data = aej_maindata_tab2)\ntab2_p1_reg7 <- lm_robust(povrate_w ~ herf + lenper,se_type = \"stata\",data = aej_maindata_tab2)\ntab2_p1_reg8 <- lm_robust(povrate_b ~ herf + lenper,se_type = \"stata\",data = aej_maindata_tab2)\n\n\n# Table 2 panel 2\n\ntab2_p2_reg1 <- lm_robust(ln90w90b ~ dism1990,se_type = \"stata\",data = aej_maindata)\ntab2_p2_reg2 <- lm_robust(ln10w10b ~ dism1990,se_type = \"stata\",data = aej_maindata)\ntab2_p2_reg3 <- lm_robust(ln90w10b ~ dism1990,se_type = \"stata\",data = aej_maindata)\ntab2_p2_reg4 <- lm_robust(ln90b10w ~ dism1990,se_type = \"stata\",data = aej_maindata)\n\ntab2_p2_ivreg1 <- iv_robust(ln90w90b ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\ntab2_p2_ivreg2 <- iv_robust(ln10w10b ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\ntab2_p2_ivreg3 <- iv_robust(ln90w10b ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\ntab2_p2_ivreg4 <- iv_robust(ln90b10w ~ dism1990 + lenper | herf + lenper, se_type = \"stata\",data = aej_maindata)\n\ntab2_p2_reg5 <- lm_robust(ln90w90b ~ herf + lenper, se_type = \"stata\",data = aej_maindata_tab2)\ntab2_p2_reg6 <- lm_robust(ln10w10b ~ herf + lenper, se_type = \"stata\",data = aej_maindata_tab2)\ntab2_p2_reg7 <- lm_robust(ln90w10b ~ herf + lenper, se_type = \"stata\",data = aej_maindata_tab2)\ntab2_p2_reg8 <- lm_robust(ln90b10w ~ herf + lenper, se_type = \"stata\",data = aej_maindata_tab2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Table 2 models\n\n# Function to get dism1990 coefficient\nget_stats <- function(model) {\n  tidy(model) %>% \n    filter(term %in% c(\"dism1990\", \"herf\")) %>% \n    select(estimate, std.error, p.value) %>% \n    as.list()\n}\n\n\ngini_list <- list(tab2_p1_reg1, tab2_p1_reg2, \n                  tab2_p1_ivreg1, tab2_p1_ivreg2, \n                  tab2_p1_reg5, tab2_p1_reg6)\n\n\npoverty_list <- list(tab2_p1_reg3, tab2_p1_reg4,\n                     tab2_p1_ivreg3, tab2_p1_ivreg4,\n                     tab2_p1_reg7, tab2_p1_reg8)\n\n\n# Get coefficients\n# For GINI row\ngini_coef <- as_tibble(t(sapply(gini_list, get_stats))) %>%\n  tibble::rownames_to_column(var = \"model_name\") %>%\n  unnest(cols = everything())\n\n# For Poverty row\npoverty_coef <- as_tibble(t(sapply(poverty_list, get_stats))) %>%\n  tibble::rownames_to_column(var = \"model_name\") %>%\n  unnest(cols = everything())\n\n# Function to make things quickier\ntable_of_coef <- function(data_coeff){\n  table <- c()\n  for (i in 1:nrow(data_coeff)){\n    coeff_est <- round(data_coeff[i,2], digits = 3)\n    if (data_coeff[i,3] <= 0.01){\n      coeff_est <- paste0(coeff_est, \"***\")\n    } else if (data_coeff[i,3] > 0.01 & data_coeff[i,3] <= 0.05){\n      coeff_est <- paste0(coeff_est, \"**\")\n    } else if (data_coeff[i,3] > 0.05 & data_coeff[i,3] <= 0.1){\n      coeff_est <- paste0(coeff_est, \"*\")\n    }\n    table[i] <- paste(coeff_est, \"<br>(\", round(data_coeff[i,3], digits = 3), \")\", sep = \"\")\n  }\n  return(table)\n}\n\n\n# Getting the coefficeints in matrix form\ntable_2_gini <- table_of_coef(gini_coef)\ntable_2_poverty <- table_of_coef(poverty_coef)\n\n# Matrix first penal Table 2\ntable_2_matrix_first <- matrix(cbind(table_2_gini, table_2_poverty), ncol =  6, byrow  = T)\n\n# Add column name first half of the table\ncolnames(table_2_matrix_first) <- rep(c(\"White\", \"Black\"), 3)\n\n# Add rownames\nrownames(table_2_matrix_first) <- c(\"Gini index\", \"Poverty rate\")\n\n# Generate first half the table 2\ntable_2_first_kable <- kable(table_2_matrix_first, \"html\", escape = FALSE, align = c( 'l', 'c', 'l', 'c', 'l', 'c'), caption = \" Table 2 - upper half\") %>%\n  add_header_above(c(\"Outcome: \" = 1, \"OLS: Effect of 1990 \ndissimilarity index\" = 2, \"Main results: 2SLS RDI as instrument for 1990 dissimilarity\" = 2, \"Falsification: Reduced form effect  of RDI among cities  far from the south\" = 2))\n\n\n# Second part of the table \n# OLS: Effect of 1990  dissimilarity index - White:Blacks ration\nfirst_column <- list(tab2_p2_reg1, tab2_p2_reg2,\n                     tab2_p2_reg3, tab2_p2_reg4)\n\n# Get coefficients\nfirst_matrix <- as_tibble(t(sapply(first_column, get_stats))) %>%\n  tibble::rownames_to_column(var = \"model_name\") %>%\n  unnest(cols = everything()) %>%\n  table_of_coef()\n\n\n# Main results: 2SLS RDI as instrument for  1990 dissimilarity - White:Blacks ration\nsecond_column <- list(tab2_p2_ivreg1, tab2_p2_ivreg2, \n                      tab2_p2_ivreg3, tab2_p2_ivreg4)\n\nsecond_matrix <- as_tibble(t(sapply(second_column, get_stats))) %>%\n  tibble::rownames_to_column(var = \"model_name\") %>%\n  unnest(cols = everything()) %>%\n  table_of_coef()\n\n# Falsification:  Reduced form effect  of RDI among cities far from the south - White:Blacks ration\nthird_column <- list(tab2_p2_reg5, tab2_p2_reg6,\n                     tab2_p2_reg7, tab2_p2_reg8)\n\nthird_matrix <- as_tibble(t(sapply(third_column, get_stats))) %>%\n  tibble::rownames_to_column(var = \"model_name\") %>%\n  unnest(cols = everything()) %>%\n  table_of_coef()\n\n# Bind columns\ntable_2_matrix_second <- cbind(first_matrix, second_matrix, third_matrix) %>%\n  rbind(c(121, 121, 29)) # Adds the size of the sample\n\n# Change colnames to nothing\ncolnames(table_2_matrix_second) <- c(\"\", \"\", \"\")\n\n\n# Change rownames\nrownames(table_2_matrix_second) <- c(\"90 white: 90 black\",\n                                     \"10 white: 10 black\", \n                                     \"90 white: 10 black\", \n                                     \"90 black: 10 white\", \n                                     \"N\")\n\n\n# Generate first half the table 2\ntable_2_second_kable <- kable(table_2_matrix_second, \"html\", escape = FALSE, align = c( 'c', 'c', 'c'), caption = \" Table 2 - lower half\") %>%\n  add_header_above(c(\"Between-race inequality\" = 1, \"OLS: Effect of 1990 \ndissimilarity index\" = 1, \"Main results: 2SLS RDI as instrument for 1990 dissimilarity\" = 1, \"Falsification: Reduced form effect  of RDI among cities  far from the south\" = 1))\n```\n:::\n\n\n```{.r .cell-code}\n# Print the table\ntable_2_first_kable\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption> Table 2 - upper half</caption>\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: </div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">OLS: Effect of 1990 <br>dissimilarity index</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Main results: 2SLS RDI as instrument for 1990 dissimilarity</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Falsification: Reduced form effect  of RDI among cities  far from the south</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> White </th>\n   <th style=\"text-align:center;\"> Black </th>\n   <th style=\"text-align:left;\"> White </th>\n   <th style=\"text-align:center;\"> Black </th>\n   <th style=\"text-align:left;\"> White </th>\n   <th style=\"text-align:center;\"> Black </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gini index </td>\n   <td style=\"text-align:left;\"> -0.079**<br>(0.037) </td>\n   <td style=\"text-align:center;\"> 0.459*<br>(0.093) </td>\n   <td style=\"text-align:left;\"> -0.334*<br>(0.099) </td>\n   <td style=\"text-align:center;\"> 0.875<br>(0.409) </td>\n   <td style=\"text-align:left;\"> -0.11*<br>(0.066) </td>\n   <td style=\"text-align:center;\"> 0.167<br>(0.424) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Poverty rate </td>\n   <td style=\"text-align:left;\"> -0.073**<br>(0.019) </td>\n   <td style=\"text-align:center;\"> 0.182**<br>(0.045) </td>\n   <td style=\"text-align:left;\"> -0.196*<br>(0.065) </td>\n   <td style=\"text-align:center;\"> 0.258<br>(0.108) </td>\n   <td style=\"text-align:left;\"> -0.036**<br>(0.035) </td>\n   <td style=\"text-align:center;\"> -0.136*<br>(0.094) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n\n```{.r .cell-code}\n# Print the table\ntable_2_second_kable\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption> Table 2 - lower half</caption>\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Between-race inequality</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">OLS: Effect of 1990 <br>dissimilarity index</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Main results: 2SLS RDI as instrument for 1990 dissimilarity</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Falsification: Reduced form effect  of RDI among cities  far from the south</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\">  </th>\n   <th style=\"text-align:center;\">  </th>\n   <th style=\"text-align:center;\">  </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 90 white: 90 black </td>\n   <td style=\"text-align:center;\"> 0.111*<br>(0.086) </td>\n   <td style=\"text-align:center;\"> -0.131<br>(0.312) </td>\n   <td style=\"text-align:center;\"> -0.443<br>(0.217) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 white: 10 black </td>\n   <td style=\"text-align:center;\"> 1.295<br>(0.249) </td>\n   <td style=\"text-align:center;\"> 2.727<br>(0.867) </td>\n   <td style=\"text-align:center;\"> -0.135<br>(0.532) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 90 white: 10 black </td>\n   <td style=\"text-align:center;\"> 1.172<br>(0.282) </td>\n   <td style=\"text-align:center;\"> 1.789<br>(0.758) </td>\n   <td style=\"text-align:center;\"> -0.449<br>(0.558) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 90 black: 10 white </td>\n   <td style=\"text-align:center;\"> -0.234<br>(0.131) </td>\n   <td style=\"text-align:center;\"> -0.807<br>(0.384) </td>\n   <td style=\"text-align:center;\"> 0.13<br>(0.248) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:center;\"> 121 </td>\n   <td style=\"text-align:center;\"> 121 </td>\n   <td style=\"text-align:center;\"> 29 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n\n## Table 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Table 3 \n\ntab3_ivreg1 <- iv_robust(lngini_w ~ dism1990 + lenper + pop1990 |herf + lenper + pop1990 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg2 <- iv_robust(lngini_b ~ dism1990 + lenper + pop1990 |herf + lenper + pop1990 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg3 <- iv_robust(povrate_w ~ dism1990 + lenper + pop1990 |herf + lenper + pop1990 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg4 <- iv_robust(povrate_b ~ dism1990 + lenper + pop1990 |herf + lenper + pop1990 ,se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg5 <- iv_robust(lngini_w ~ dism1990 + lenper + pctbk1990 |herf + lenper + pctbk1990 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg6 <- iv_robust(lngini_b ~ dism1990 + lenper + pctbk1990 |herf + lenper + pctbk1990 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg7 <- iv_robust(povrate_w ~ dism1990 + lenper + pctbk1990 |herf + lenper + pctbk1990 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg8 <- iv_robust(povrate_b ~ dism1990 + lenper + pctbk1990 |herf + lenper + pctbk1990 ,se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg9 <- iv_robust(lngini_w ~ dism1990 + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b |\n                           herf + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b ,\n                         se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg10 <- iv_robust(lngini_b ~ dism1990 + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b |\n                           herf + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b ,\n                         se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg11 <- iv_robust(povrate_w ~ dism1990 + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b |\n                           herf + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b ,\n                         se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg12 <- iv_robust(povrate_b ~ dism1990 + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b |\n                           herf + lenper + hsdrop_w + hsgrad_w + somecoll_w + collgrad_w + hsdrop_b + hsgrad_b + somecoll_b + collgrad_b ,\n                         se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg13 <- iv_robust(lngini_w ~ dism1990 + lenper + manshr |herf + lenper + manshr ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg14 <- iv_robust(lngini_b ~ dism1990 + lenper + manshr |herf + lenper + manshr ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg15 <- iv_robust(povrate_w ~ dism1990 + lenper + manshr |herf + lenper + manshr ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg16 <- iv_robust(povrate_b ~ dism1990 + lenper + manshr |herf + lenper + manshr ,se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg17 <- iv_robust(lngini_w ~ dism1990 + lenper + lfp_w + lfp_b |herf + lenper + lfp_w + lfp_b ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg18 <- iv_robust(lngini_b ~ dism1990 + lenper + lfp_w + lfp_b |herf + lenper + lfp_w + lfp_b ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg19 <- iv_robust(povrate_w ~ dism1990 + lenper + lfp_w + lfp_b |herf + lenper + lfp_w + lfp_b ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg20 <- iv_robust(povrate_b ~ dism1990 + lenper + lfp_w + lfp_b |herf + lenper + lfp_w + lfp_b ,se_type = \"stata\",data = aej_maindata)\n\n\ntab3_ivreg21 <- iv_robust(lngini_w ~ dism1990 + lenper + ngov62 |herf + lenper + ngov62 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg22 <- iv_robust(lngini_b ~ dism1990 + lenper + ngov62 |herf + lenper + ngov62 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg23 <- iv_robust(povrate_w ~ dism1990 + lenper + ngov62 |herf + lenper + ngov62 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg24 <- iv_robust(povrate_b ~ dism1990 + lenper + ngov62 |herf + lenper + ngov62 ,se_type = \"stata\",data = aej_maindata)\n\n\ntab3_ivreg25 <- iv_robust(lngini_w ~ dism1990 + lenper + count1920 |herf + lenper + count1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg26 <- iv_robust(lngini_b ~ dism1990 + lenper + count1920 |herf + lenper + count1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg27 <- iv_robust(povrate_w ~ dism1990 + lenper + count1920 |herf + lenper + count1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg28 <- iv_robust(povrate_b ~ dism1990 + lenper + count1920 |herf + lenper + count1920 ,se_type = \"stata\",data = aej_maindata)\n\n\ntab3_ivreg29 <- iv_robust(lngini_w ~ dism1990 + lenper + black1920 |herf + lenper + black1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg30 <- iv_robust(lngini_b ~ dism1990 + lenper + black1920 |herf + lenper + black1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg31 <- iv_robust(povrate_w ~ dism1990 + lenper + black1920 |herf + lenper + black1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg32 <- iv_robust(povrate_b ~ dism1990 + lenper + black1920 |herf + lenper + black1920 ,se_type = \"stata\",data = aej_maindata)\n\n\ntab3_ivreg33 <- iv_robust(lngini_w ~ dism1990 + lenper + ctyliterate1920 |herf + lenper + ctyliterate1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg34 <- iv_robust(lngini_b ~ dism1990 + lenper + ctyliterate1920 |herf + lenper + ctyliterate1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg35 <- iv_robust(povrate_w ~ dism1990 + lenper + ctyliterate1920 |herf + lenper + ctyliterate1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg36 <- iv_robust(povrate_b ~ dism1990 + lenper + ctyliterate1920 |herf + lenper + ctyliterate1920 ,se_type = \"stata\",data = aej_maindata)\n\n\ntab3_ivreg37 <- iv_robust(lngini_w ~ dism1990 + lenper + ctymanuf_wkrs1920 |herf + lenper + ctymanuf_wkrs1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg38 <- iv_robust(lngini_b ~ dism1990 + lenper + ctymanuf_wkrs1920 |herf + lenper + ctymanuf_wkrs1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg39 <- iv_robust(povrate_w ~ dism1990 + lenper + ctymanuf_wkrs1920 |herf + lenper + ctymanuf_wkrs1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg40 <- iv_robust(povrate_b ~ dism1990 + lenper + ctymanuf_wkrs1920 |herf + lenper + ctymanuf_wkrs1920 ,se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg41 <- iv_robust(lngini_w ~ dism1990 + lenper + lfp1920 |herf + lenper + lfp1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg42 <- iv_robust(lngini_b ~ dism1990 + lenper + lfp1920 |herf + lenper + lfp1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg43 <- iv_robust(povrate_w ~ dism1990 + lenper + lfp1920 |herf + lenper + lfp1920 ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg44 <- iv_robust(povrate_b ~ dism1990 + lenper + lfp1920 |herf + lenper + lfp1920 ,se_type = \"stata\",data = aej_maindata)\n\ntab3_ivreg45 <- iv_robust(lngini_w ~ dism1990 + lenper + herfscore |herf + lenper + herfscore ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg46 <- iv_robust(lngini_b ~ dism1990 + lenper + herfscore |herf + lenper + herfscore ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg47 <- iv_robust(povrate_w ~ dism1990 + lenper + herfscore |herf + lenper + herfscore ,se_type = \"stata\",data = aej_maindata)\ntab3_ivreg48 <- iv_robust(povrate_b ~ dism1990 + lenper + herfscore |herf + lenper + herfscore ,se_type = \"stata\",data = aej_maindata)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the names of the regression\n# It creates string tab3_ivreg_number\nmodel_names <- paste0(\"tab3_ivreg\", 1:48)\n\n\n# List all regression models\nmodels_tab3 <- mget(model_names) \n\n# Function to get dism1990 coefficient\nget_stats <- function(model) {\n  tidy(model) %>% \n    filter(term == \"dism1990\") %>% \n    select(estimate, std.error, p.value) %>% \n    as.list()\n}\n\n\n# Get coefficients\ntab3_coef <- as_tibble(t(sapply(models_tab3, get_stats))) %>%\n  tibble::rownames_to_column(var = \"model_name\") %>%\n  unnest(cols = everything())\n\n\n# Generating the matrix with stored values\ntable_3 <- c()\n# Loop to define significance\nfor (i in 1:nrow(tab3_coef)){\n  coeff_est <- round(tab3_coef[i,2], digits = 3)\n  if (tab3_coef[i,\"p.value\"] <= 0.01){\n    coeff_est <- paste0(coeff_est, \"***\")\n  } else if (tab3_coef[i,\"p.value\"] > 0.01 & tab3_coef[i,\"p.value\"] <= 0.05){\n    coeff_est <- paste0(coeff_est, \"**\")\n  } else if (tab3_coef[i,\"p.value\"] > 0.05 & tab3_coef[i,\"p.value\"] <= 0.1){\n    coeff_est <- paste0(coeff_est, \"*\")\n  }\n  table_3[i] <- paste(coeff_est, \"<br>(\", round(tab3_coef[i,\"p.value\"], digits = 3), \")\", sep = \"\")\n}\n\ntable_3_matrix <- matrix(table_3, ncol =  4, byrow  = T)\n\n# Adds a NA row in the first and seventh row\ntable_3_matrix  <- rbind(rbind(rep(\"\", 4), table_3_matrix[1:6,]) , rbind(rep(\"\", 4), table_3_matrix[7:11,]))\n\n\n# Define column column names\ncolnames(table_3_matrix) <- c(\"White\", \"Black\", \"White\", \"Black\")\n\n# Define row names\nrow_name <- c(\"With controls for 1990 city characteristics\", \"Population\", \"Percent black\", \"Education\", \"Share employed in manufacturing\", \n                              \"Labor force participation\", \"Number of local governments (N = 69)\", \"With controls for 1920 city characteristics\",\n                              \"Population\", \"Percent black\", \"Literacy\", \"Share employed in manufacturing\", \"Labor force participation\")\n\n\n# Adding the first row to be the name of the variable\ntable_3_matrix <- cbind(row_name, table_3_matrix)\n\n# Generate the table\ntable_3_kable <- kable(table_3_matrix, \"html\", escape = FALSE, align = c('l', 'l', 'c', 'l', 'c')) %>%\n  add_header_above(c(\"Type\" = 1, \"Dependent variable: GINI\" = 2, \"Dependent variable: Poverty Rate\" = 2)) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n```\n:::\n\n\n```{.r .cell-code}\n# Print the table\ntable_3_kable\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Type</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Dependent variable: GINI</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Dependent variable: Poverty Rate</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> row_name </th>\n   <th style=\"text-align:left;\"> White </th>\n   <th style=\"text-align:center;\"> Black </th>\n   <th style=\"text-align:left;\"> White </th>\n   <th style=\"text-align:center;\"> Black </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> With controls for 1990 city characteristics </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Population </td>\n   <td style=\"text-align:left;\"> -0.371***<br>(0.001) </td>\n   <td style=\"text-align:center;\"> 0.898**<br>(0.041) </td>\n   <td style=\"text-align:left;\"> -0.212***<br>(0.002) </td>\n   <td style=\"text-align:center;\"> 0.291***<br>(0.009) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Percent black </td>\n   <td style=\"text-align:left;\"> -0.473***<br>(0.007) </td>\n   <td style=\"text-align:center;\"> 0.886<br>(0.108) </td>\n   <td style=\"text-align:left;\"> -0.241**<br>(0.014) </td>\n   <td style=\"text-align:center;\"> 0.36**<br>(0.012) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Education </td>\n   <td style=\"text-align:left;\"> -0.358***<br>(0.001) </td>\n   <td style=\"text-align:center;\"> 0.896<br>(0.181) </td>\n   <td style=\"text-align:left;\"> -0.164**<br>(0.04) </td>\n   <td style=\"text-align:center;\"> 0.216<br>(0.21) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Share employed in manufacturing </td>\n   <td style=\"text-align:left;\"> -0.359**<br>(0.043) </td>\n   <td style=\"text-align:center;\"> 1.106<br>(0.157) </td>\n   <td style=\"text-align:left;\"> -0.272**<br>(0.03) </td>\n   <td style=\"text-align:center;\"> 0.219<br>(0.264) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Labor force participation </td>\n   <td style=\"text-align:left;\"> -0.295***<br>(0.002) </td>\n   <td style=\"text-align:center;\"> 0.907**<br>(0.023) </td>\n   <td style=\"text-align:left;\"> -0.142***<br>(0) </td>\n   <td style=\"text-align:center;\"> 0.321***<br>(0.003) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Number of local governments (N = 69) </td>\n   <td style=\"text-align:left;\"> -0.386*<br>(0.062) </td>\n   <td style=\"text-align:center;\"> 0.792***<br>(0.006) </td>\n   <td style=\"text-align:left;\"> -0.118<br>(0.132) </td>\n   <td style=\"text-align:center;\"> 0.519***<br>(0.003) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> With controls for 1920 city characteristics </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Population </td>\n   <td style=\"text-align:left;\"> -0.374***<br>(0.001) </td>\n   <td style=\"text-align:center;\"> 0.899**<br>(0.044) </td>\n   <td style=\"text-align:left;\"> -0.214***<br>(0.003) </td>\n   <td style=\"text-align:center;\"> 0.281**<br>(0.016) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Percent black </td>\n   <td style=\"text-align:left;\"> -0.364***<br>(0.002) </td>\n   <td style=\"text-align:center;\"> 0.896**<br>(0.041) </td>\n   <td style=\"text-align:left;\"> -0.199***<br>(0.005) </td>\n   <td style=\"text-align:center;\"> 0.296***<br>(0.008) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Literacy </td>\n   <td style=\"text-align:left;\"> -0.312***<br>(0.004) </td>\n   <td style=\"text-align:center;\"> 1.029**<br>(0.03) </td>\n   <td style=\"text-align:left;\"> -0.163***<br>(0.009) </td>\n   <td style=\"text-align:center;\"> 0.27**<br>(0.031) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Share employed in manufacturing </td>\n   <td style=\"text-align:left;\"> -0.401***<br>(0.003) </td>\n   <td style=\"text-align:center;\"> 0.904*<br>(0.064) </td>\n   <td style=\"text-align:left;\"> -0.213***<br>(0.01) </td>\n   <td style=\"text-align:center;\"> 0.307**<br>(0.013) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Labor force participation </td>\n   <td style=\"text-align:left;\"> -0.305***<br>(0) </td>\n   <td style=\"text-align:center;\"> 0.849**<br>(0.024) </td>\n   <td style=\"text-align:left;\"> -0.187***<br>(0.003) </td>\n   <td style=\"text-align:center;\"> 0.243**<br>(0.021) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n<p style=\"text-align:center\">Note: *** p<0.01, ** p<0.05, * p<0.1. The p-values denote the significance level of the coefficients.</p>\n\n\n## Table 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Table 4 \n\ntab4_reg1 <- lm_robust(mv_st_winus_w ~ dism1990, se_type = \"stata\",data = aej_maindata)\ntab4_reg2 <- lm_robust(mv_st_winus_b ~ dism1990, se_type = \"stata\",data = aej_maindata)\ntab4_reg3 <- lm_robust(medgrent_w ~ dism1990, se_type = \"stata\",data = aej_maindata)\ntab4_reg4 <- lm_robust(medgrent_b ~ dism1990, se_type = \"stata\",data = aej_maindata)\ntab4_reg5 <- lm_robust(medgrentpinc_w ~ dism1990, se_type = \"stata\",data = aej_maindata)\ntab4_reg6 <- lm_robust(medgrentpinc_b ~ dism1990, se_type = \"stata\",data = aej_maindata)\ntab4_reg7 <- lm_robust(mt1proom_w ~ dism1990, se_type = \"stata\",data = aej_maindata)\ntab4_reg8 <- lm_robust(mt1proom_b ~ dism1990, se_type = \"stata\",data = aej_maindata)\n\ntab4_ivreg1 <- feols(mv_st_winus_w ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\ntab4_ivreg2 <- feols(mv_st_winus_b ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\ntab4_ivreg3 <- feols(medgrent_w ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\ntab4_ivreg4 <- feols(medgrent_b ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\ntab4_ivreg5 <- feols(medgrentpinc_w ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\ntab4_ivreg6 <- feols(medgrentpinc_b ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\ntab4_ivreg7 <- feols(mt1proom_w ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\ntab4_ivreg8 <- feols(mt1proom_b ~ lenper | dism1990 ~ herf, vcov = \"HC1\", data = aej_maindata)\n\ntab4_reg9 <- feols(mv_st_winus_w ~ herf +lenper, vcov = \"HC1\", data = aej_maindata_tab2)\ntab4_reg10 <- feols(mv_st_winus_b ~ herf + lenper, vcov = \"HC1\", data = aej_maindata_tab2)\ntab4_reg11 <- feols(medgrent_w ~ herf + lenper, vcov = \"HC1\", data = aej_maindata_tab2)\ntab4_reg12 <- feols(medgrent_b ~ herf +lenper, vcov = \"HC1\", data = aej_maindata_tab2)\ntab4_reg13 <- feols(medgrentpinc_w ~ herf +  lenper, vcov = \"HC1\", data = aej_maindata_tab2)\ntab4_reg14 <- feols(medgrentpinc_b ~ herf + lenper, vcov = \"HC1\", data = aej_maindata_tab2)\ntab4_reg15 <- feols(mt1proom_w ~ herf + lenper, vcov = \"HC1\", data = aej_maindata_tab2)\ntab4_reg16 <- feols(mt1proom_b ~ herf + lenper, vcov = \"HC1\", data = aej_maindata_tab2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodels <- list()\nmodels[[\"% Migrant\"]][[\"White\"]] <- tab4_reg1\nmodels[[\"% Migrant\"]][[\"Black\"]] <- tab4_reg2\nmodels[[\"Median rent\"]][[\"White\"]] <- tab4_reg3\nmodels[[\"Median rent\"]][[\"Black\"]] <- tab4_reg4\nmodels[[\"Median rent / income\"]][[\"White\"]] <- tab4_reg5\nmodels[[\"Median rent / income\"]][[\"Black\"]] <- tab4_reg6\nmodels[[\"% More than 1 by room\"]][[\"White\"]] <- tab4_reg7\nmodels[[\"% More than 1 by room\"]][[\"Black\"]] <- tab4_reg8\n\nmodels_unlisted <- unlist(models,recursive = F)\nnames(models_unlisted) <- c(\"White\",\"Black\",\"White\",\"Black\",\"White\",\"Black\",\"White\",\"Black\")\n\n\nrows <- tribble(~term, ~White,~Black,~White,~Black,~White,~Black,~White,~Black,\n                \"IV\", tab4_ivreg1$coefficients[2],tab4_ivreg2$coefficients[2],tab4_ivreg3$coefficients[2],tab4_ivreg4$coefficients[2],tab4_ivreg5$coefficients[2],tab4_ivreg6$coefficients[2],tab4_ivreg7$coefficients[2],tab4_ivreg8$coefficients[2],\n                \" \", tab4_ivreg1$se[2],tab4_ivreg2$se[2],tab4_ivreg3$se[2],tab4_ivreg4$se[2],tab4_ivreg5$se[2],tab4_ivreg6$se[2],tab4_ivreg7$se[2],tab4_ivreg8$se[2],\n                \"Falsification\", tab4_reg9$coefficients[2],tab4_reg10$coefficients[2],tab4_reg11$coefficients[2],tab4_reg12$coefficients[2],tab4_reg13$coefficients[2],tab4_reg14$coefficients[2],tab4_reg15$coefficients[2],tab4_reg16$coefficients[2],\n                \" \", tab4_reg9$se[2],tab4_reg10$se[2],tab4_reg11$se[2],tab4_reg12$se[2],tab4_reg13$se[2],tab4_reg14$se[2],tab4_reg15$se[2],tab4_reg16$se[2])\n\n\nmsummary(models_unlisted,\n         title = \"Table 4 - The Effects of 1990 Segregation on 1990 City Demand\",\n         output = \"kableExtra\",\n         allign = \"lcccc\",  \n         coef_omit = -2,\n         coef_rename = \"OLS\",\n         gof_map = NA,\n         add_rows = rows) %>%\n  add_header_above(c(\" \" = 1,\"Outcome: Percent of residents who are in-migrants\" = 2,\"Outcome: Median rent\" = 2,\"Outcome: Median as a percent of income\" = 2,\"Outcome: Share of households with more than one person per room\" = 2), align = \"cccc\", underline = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Table 4 - The Effects of 1990 Segregation on 1990 City Demand</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Percent of residents who are in-migrants</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Median rent</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Median as a percent of income</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Share of households with more than one person per room</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> White </th>\n   <th style=\"text-align:center;\"> Black </th>\n   <th style=\"text-align:center;\"> White  </th>\n   <th style=\"text-align:center;\"> Black  </th>\n   <th style=\"text-align:center;\"> White   </th>\n   <th style=\"text-align:center;\"> Black   </th>\n   <th style=\"text-align:center;\"> White    </th>\n   <th style=\"text-align:center;\"> Black    </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> OLS </td>\n   <td style=\"text-align:center;\"> -0.153 </td>\n   <td style=\"text-align:center;\"> -0.294 </td>\n   <td style=\"text-align:center;\"> -313.851 </td>\n   <td style=\"text-align:center;\"> -391.813 </td>\n   <td style=\"text-align:center;\"> -8.535 </td>\n   <td style=\"text-align:center;\"> -3.490 </td>\n   <td style=\"text-align:center;\"> -0.062 </td>\n   <td style=\"text-align:center;\"> -0.103 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (0.032) </td>\n   <td style=\"text-align:center;\"> (0.052) </td>\n   <td style=\"text-align:center;\"> (83.934) </td>\n   <td style=\"text-align:center;\"> (75.643) </td>\n   <td style=\"text-align:center;\"> (1.337) </td>\n   <td style=\"text-align:center;\"> (2.676) </td>\n   <td style=\"text-align:center;\"> (0.014) </td>\n   <td style=\"text-align:center;\"> (0.022) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> IV </td>\n   <td style=\"text-align:center;\"> -0.155 </td>\n   <td style=\"text-align:center;\"> -0.271 </td>\n   <td style=\"text-align:center;\"> -636.453 </td>\n   <td style=\"text-align:center;\"> -623.642 </td>\n   <td style=\"text-align:center;\"> -16.666 </td>\n   <td style=\"text-align:center;\"> -3.416 </td>\n   <td style=\"text-align:center;\"> -0.116 </td>\n   <td style=\"text-align:center;\"> -0.165 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> 0.073 </td>\n   <td style=\"text-align:center;\"> 0.115 </td>\n   <td style=\"text-align:center;\"> 276.151 </td>\n   <td style=\"text-align:center;\"> 156.969 </td>\n   <td style=\"text-align:center;\"> 3.643 </td>\n   <td style=\"text-align:center;\"> 5.387 </td>\n   <td style=\"text-align:center;\"> 0.037 </td>\n   <td style=\"text-align:center;\"> 0.047 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Falsification </td>\n   <td style=\"text-align:center;\"> 0.019 </td>\n   <td style=\"text-align:center;\"> 0.058 </td>\n   <td style=\"text-align:center;\"> 295.092 </td>\n   <td style=\"text-align:center;\"> 326.160 </td>\n   <td style=\"text-align:center;\"> 0.427 </td>\n   <td style=\"text-align:center;\"> 3.660 </td>\n   <td style=\"text-align:center;\"> 0.034 </td>\n   <td style=\"text-align:center;\"> 0.062 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> 0.063 </td>\n   <td style=\"text-align:center;\"> 0.158 </td>\n   <td style=\"text-align:center;\"> 275.735 </td>\n   <td style=\"text-align:center;\"> 158.217 </td>\n   <td style=\"text-align:center;\"> 2.061 </td>\n   <td style=\"text-align:center;\"> 3.572 </td>\n   <td style=\"text-align:center;\"> 0.038 </td>\n   <td style=\"text-align:center;\"> 0.048 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Table 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Separating the table 5 data into the two desired groups --------------------------------------------------------\n\ntable_5_black <- table_5 %>%\n  filter(black == 1)\n\ntable_5_nonblack <- table_5 %>%\n  filter(black == 0)\n\n#-----------------------------------------------------------------------------------------------------------------\n\ntab5_reg1 <- lm_robust(hsdrop ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_nonblack)\ntab5_reg2 <- lm_robust(hsdrop ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_black)\ntab5_reg3 <- lm_robust(hsgrad ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_nonblack)\ntab5_reg4 <- lm_robust(hsgrad ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_black)\ntab5_reg5 <- lm_robust(somecoll ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_nonblack)\ntab5_reg6 <- lm_robust(somecoll ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_black)\ntab5_reg7 <- lm_robust(collgrad ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_nonblack)\ntab5_reg8 <- lm_robust(collgrad ~ dism1980 + agedum1 + agedum2 + agedum3 + agedum4 + agedum5 + agedum6 + agedum7 + agedum8 + agedum9,\n                       clusters = name,data = table_5_black)\n\ntab5_ivreg1 <- feols(hsdrop ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_nonblack)\ntab5_ivreg2 <- feols(hsdrop ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_black)\ntab5_ivreg3 <- feols(hsgrad ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_nonblack)\ntab5_ivreg4 <- feols(hsgrad ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_black)\ntab5_ivreg5 <- feols(somecoll ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_nonblack)\ntab5_ivreg6 <- feols(somecoll ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_black)\ntab5_ivreg7 <- feols(collgrad ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_nonblack)\ntab5_ivreg8 <- feols(collgrad ~ lenper | age | dism1980 ~ herf, cluster = \"name\",data = table_5_black)\n# Filtering the close data ---------------------------------------------------------------------------------------------\n\ntable5_black_close <- table_5_black %>%\n  filter(closeness < -400)\ntable5_nonblack_close <- table_5_nonblack %>%\n  filter(closeness < -400)\n# ----------------------------------------------------------------------------------------------------------------------\ntab5_reg9 <- feols(hsdrop ~ herf + lenper |age , cluster = \"name\", data = table5_nonblack_close)\ntab5_reg10 <- feols(hsdrop ~ herf + lenper |age , cluster = \"name\", data = table5_black_close)\ntab5_reg11 <- feols(hsgrad ~ herf + lenper |age , cluster = \"name\", data = table5_nonblack_close)\ntab5_reg12 <- feols(hsgrad ~ herf + lenper |age , cluster = \"name\", data = table5_black_close)\ntab5_reg13 <- feols(somecoll ~ herf + lenper |age , cluster = \"name\", data = table5_nonblack_close)\ntab5_reg14 <- feols(somecoll ~ herf + lenper |age , cluster = \"name\", data = table5_black_close)\ntab5_reg15 <- feols(collgrad ~ herf + lenper |age , cluster = \"name\", data = table5_nonblack_close)\ntab5_reg16 <- feols(collgrad ~ herf + lenper |age , cluster = \"name\", data = table5_black_close)\n```\n:::\n\n\n```{.r .cell-code}\nmodels <- list()\nmodels[[\"HS dropout\"]][[\"White\"]] <- tab5_reg1\nmodels[[\"HS dropout\"]][[\"Black\"]] <- tab5_reg2\nmodels[[\"HS graduate\"]][[\"White\"]] <- tab5_reg3\nmodels[[\"HS graduate\"]][[\"Black\"]] <- tab5_reg4\nmodels[[\"Some college\"]][[\"White\"]] <- tab5_reg5\nmodels[[\"Some college\"]][[\"Black\"]] <- tab5_reg6\nmodels[[\"College graduate\"]][[\"White\"]] <- tab5_reg7\nmodels[[\"College graduate\"]][[\"Black\"]] <- tab5_reg8\n\nmodels_unlisted <- unlist(models,recursive = F)\nnames(models_unlisted) <- c(\"White\",\"Black\",\"White\",\"Black\",\"White\",\"Black\",\"White\",\"Black\")\n\nrows <- tribble(~term, ~White,~Black,~White,~Black,~White,~Black,~White,~Black,\n                \"IV\", tab5_ivreg1$coefficients[1],tab5_ivreg2$coefficients[1],tab5_ivreg3$coefficients[1],tab5_ivreg4$coefficients[1],tab5_ivreg5$coefficients[1],tab5_ivreg6$coefficients[1],tab5_ivreg7$coefficients[1],tab5_ivreg8$coefficients[1],\n                \" \", tab5_ivreg1$se[1],tab5_ivreg2$se[1],tab5_ivreg3$se[1],tab5_ivreg4$se[1],tab5_ivreg5$se[1],tab5_ivreg6$se[1],tab5_ivreg7$se[1],tab5_ivreg8$se[1],\n                \"Falsification\", tab5_reg9$coefficients[1],tab5_reg10$coefficients[1],tab5_reg11$coefficients[1],tab5_reg12$coefficients[1],tab5_reg13$coefficients[1],tab5_reg14$coefficients[1],tab5_reg15$coefficients[1],tab5_reg16$coefficients[1],\n                \" \", tab5_reg9$se[1],tab5_reg10$se[1],tab5_reg11$se[1],tab5_reg12$se[1],tab5_reg13$se[1],tab5_reg14$se[1],tab5_reg15$se[1],tab5_reg16$se[1],)\n\n\nmsummary(models_unlisted,\n         output = \"kableExtra\",\n         title = \"Table 5 - The effects of 1980 dissimilarity on human capital of 22- to 30-year-olds in 1980 \",\n         allign = \"lcccc\",  \n         coef_omit = -2,\n         coef_rename = \"OLS\",\n         gof_map = NA,\n         add_rows = rows) %>%\n  add_header_above(c(\" \" = 1,\"Outcome: Share who are high school dropouts\" = 2,\"Outcome: Share who are high school graduates\" = 2,\"Outcome: Share who have some college\" = 2,\"Outcome: Share who are college graduates\" = 2), align = \"cccc\",underline = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Table 5 - The effects of 1980 dissimilarity on human capital of 22- to 30-year-olds in 1980 </caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Share who are high school dropouts</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Share who are high school graduates</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Share who have some college</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: cccc; text-decoration: underline; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Outcome: Share who are college graduates</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> White </th>\n   <th style=\"text-align:center;\"> Black </th>\n   <th style=\"text-align:center;\"> White  </th>\n   <th style=\"text-align:center;\"> Black  </th>\n   <th style=\"text-align:center;\"> White   </th>\n   <th style=\"text-align:center;\"> Black   </th>\n   <th style=\"text-align:center;\"> White    </th>\n   <th style=\"text-align:center;\"> Black    </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> OLS </td>\n   <td style=\"text-align:center;\"> 0.025 </td>\n   <td style=\"text-align:center;\"> 0.354 </td>\n   <td style=\"text-align:center;\"> 0.249 </td>\n   <td style=\"text-align:center;\"> 0.262 </td>\n   <td style=\"text-align:center;\"> -0.153 </td>\n   <td style=\"text-align:center;\"> -0.355 </td>\n   <td style=\"text-align:center;\"> -0.121 </td>\n   <td style=\"text-align:center;\"> -0.262 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (0.039) </td>\n   <td style=\"text-align:center;\"> (0.088) </td>\n   <td style=\"text-align:center;\"> (0.060) </td>\n   <td style=\"text-align:center;\"> (0.139) </td>\n   <td style=\"text-align:center;\"> (0.043) </td>\n   <td style=\"text-align:center;\"> (0.142) </td>\n   <td style=\"text-align:center;\"> (0.090) </td>\n   <td style=\"text-align:center;\"> (0.128) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> IV </td>\n   <td style=\"text-align:center;\"> -0.144 </td>\n   <td style=\"text-align:center;\"> 0.431 </td>\n   <td style=\"text-align:center;\"> 0.458 </td>\n   <td style=\"text-align:center;\"> 0.652 </td>\n   <td style=\"text-align:center;\"> -0.174 </td>\n   <td style=\"text-align:center;\"> -0.786 </td>\n   <td style=\"text-align:center;\"> -0.140 </td>\n   <td style=\"text-align:center;\"> -0.297 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> 0.149 </td>\n   <td style=\"text-align:center;\"> 0.201 </td>\n   <td style=\"text-align:center;\"> 0.174 </td>\n   <td style=\"text-align:center;\"> 0.333 </td>\n   <td style=\"text-align:center;\"> 0.110 </td>\n   <td style=\"text-align:center;\"> 0.321 </td>\n   <td style=\"text-align:center;\"> 0.152 </td>\n   <td style=\"text-align:center;\"> 0.219 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Falsification </td>\n   <td style=\"text-align:center;\"> 0.089 </td>\n   <td style=\"text-align:center;\"> 0.100 </td>\n   <td style=\"text-align:center;\"> -0.003 </td>\n   <td style=\"text-align:center;\"> 0.320 </td>\n   <td style=\"text-align:center;\"> -0.021 </td>\n   <td style=\"text-align:center;\"> -0.274 </td>\n   <td style=\"text-align:center;\"> -0.065 </td>\n   <td style=\"text-align:center;\"> -0.146 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> 0.085 </td>\n   <td style=\"text-align:center;\"> 0.235 </td>\n   <td style=\"text-align:center;\"> 0.086 </td>\n   <td style=\"text-align:center;\"> 0.292 </td>\n   <td style=\"text-align:center;\"> 0.064 </td>\n   <td style=\"text-align:center;\"> 0.300 </td>\n   <td style=\"text-align:center;\"> 0.079 </td>\n   <td style=\"text-align:center;\"> 0.232 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n",
    "supporting": [
      "replication_wrong_side_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"replication_wrong_side_files/libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"replication_wrong_side_files/libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}